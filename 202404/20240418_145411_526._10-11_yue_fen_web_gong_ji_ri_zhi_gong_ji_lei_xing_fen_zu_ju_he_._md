# 查询10月份web攻击日志攻击类型分组聚合
```
GET /anyu_attack_detail_202310/_search
{
  "size": 0,
  "query": {
    "bool": {
      "must_not": [
        {
          "term": {
            "domain": {
              "value": ""
            }
          }
        },
        {
          "term": {
            "actionflag": {
              "value": "PASS"
            }
          }
        }
      ]
    }
  },
  "aggs": {
    "result": {
      "terms": {
        "field": "type",
        "size": 1000
      }
    }
  }
}
```

```
{
  "took": 4582,
  "timed_out": false,
  "_shards": {
    "total": 30,
    "successful": 30,
    "skipped": 0,
    "failed": 0
  },
  "hits": {
    "total": 320616807,
    "max_score": 0,
    "hits": []
  },
  "aggregations": {
    "result": {
      "doc_count_error_upper_bound": 0,
      "sum_other_doc_count": 0,
      "buckets": [
        {
          "key": "Information Leak Attack",
          "doc_count": 145000749
        },
        {
          "key": "SQL Inject",
          "doc_count": 35904417
        },
        {
          "key": "SCANNER",
          "doc_count": 31659413
        },
        {
          "key": "LFI",
          "doc_count": 28161680
        },
        {
          "key": "Common Vulnerability",
          "doc_count": 25195901
        },
        {
          "key": "Backup File Attack",
          "doc_count": 17870494
        },
        {
          "key": "Other",
          "doc_count": 11663937
        },
        {
          "key": "WEBSHELL",
          "doc_count": 7600181
        },
        {
          "key": "XSS",
          "doc_count": 7140521
        },
        {
          "key": "Base64 Detect",
          "doc_count": 2334281
        },
        {
          "key": "Remote Code with Expression Language Injection Attack",
          "doc_count": 1513935
        },
        {
          "key": "nginx attack",
          "doc_count": 1467728
        },
        {
          "key": "Code Injection",
          "doc_count": 1405678
        },
        {
          "key": "System Command Attack",
          "doc_count": 1146251
        },
        {
          "key": "Upload Webshell Attack",
          "doc_count": 934837
        },
        {
          "key": "Command Injection",
          "doc_count": 883663
        },
        {
          "key": "RFI",
          "doc_count": 249559
        },
        {
          "key": "PHP Injection",
          "doc_count": 175291
        },
        {
          "key": "Sensitive Check",
          "doc_count": 104383
        },
        {
          "key": "LDAP Injection",
          "doc_count": 82773
        },
        {
          "key": "UA",
          "doc_count": 55643
        },
        {
          "key": "SSI injection",
          "doc_count": 28279
        },
        {
          "key": "360webscan",
          "doc_count": 20173
        },
        {
          "key": "protocol invalidation",
          "doc_count": 13688
        },
        {
          "key": "HTTP Response Splitting Attack",
          "doc_count": 3062
        },
        {
          "key": "Anti CSRF Attack",
          "doc_count": 138
        },
        {
          "key": "Php-cgi Remote Code Exec Attack",
          "doc_count": 108
        },
        {
          "key": "buffer overflow",
          "doc_count": 30
        },
        {
          "key": "Ddos attack",
          "doc_count": 14
        }
      ]
    }
  }
}
```

# 11月份的聚合数据
```
{
  "took": 5057,
  "timed_out": false,
  "_shards": {
    "total": 30,
    "successful": 30,
    "skipped": 0,
    "failed": 0
  },
  "hits": {
    "total": 132320585,
    "max_score": 0,
    "hits": []
  },
  "aggregations": {
    "result": {
      "doc_count_error_upper_bound": 0,
      "sum_other_doc_count": 0,
      "buckets": [
        {
          "key": "Information Leak Attack",
          "doc_count": 56619925
        },
        {
          "key": "SQL Inject",
          "doc_count": 16396133
        },
        {
          "key": "SCANNER",
          "doc_count": 14536643
        },
        {
          "key": "LFI",
          "doc_count": 13504172
        },
        {
          "key": "Backup File Attack",
          "doc_count": 9173098
        },
        {
          "key": "Common Vulnerability",
          "doc_count": 8259047
        },
        {
          "key": "Other",
          "doc_count": 4729467
        },
        {
          "key": "XSS",
          "doc_count": 2915379
        },
        {
          "key": "WEBSHELL",
          "doc_count": 2891343
        },
        {
          "key": "Code Injection",
          "doc_count": 610487
        },
        {
          "key": "Remote Code with Expression Language Injection Attack",
          "doc_count": 587157
        },
        {
          "key": "nginx attack",
          "doc_count": 478826
        },
        {
          "key": "Base64 Detect",
          "doc_count": 439771
        },
        {
          "key": "System Command Attack",
          "doc_count": 391046
        },
        {
          "key": "Command Injection",
          "doc_count": 332093
        },
        {
          "key": "Upload Webshell Attack",
          "doc_count": 211666
        },
        {
          "key": "PHP Injection",
          "doc_count": 59192
        },
        {
          "key": "RFI",
          "doc_count": 57553
        },
        {
          "key": "LDAP Injection",
          "doc_count": 52581
        },
        {
          "key": "UA",
          "doc_count": 31067
        },
        {
          "key": "SSI injection",
          "doc_count": 20763
        },
        {
          "key": "Sensitive Check",
          "doc_count": 14172
        },
        {
          "key": "360webscan",
          "doc_count": 5143
        },
        {
          "key": "protocol invalidation",
          "doc_count": 2213
        },
        {
          "key": "HTTP Response Splitting Attack",
          "doc_count": 1132
        },
        {
          "key": "Php-cgi Remote Code Exec Attack",
          "doc_count": 401
        },
        {
          "key": "Anti CSRF Attack",
          "doc_count": 112
        },
        {
          "key": "Ddos attack",
          "doc_count": 3
        }
      ]
    }
  }
}
```